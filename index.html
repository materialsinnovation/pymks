

<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Materials Knowledge Systems in Python &mdash; PyMKS</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.1.0/cosmo/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pymks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="_static/pymks_logo.ico"/>
    <link rel="top" title="PyMKS" href="#" />
    <link rel="next" title="Theory" href="THEORY.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#"><img src="_static/pymks_logo.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="rst/INSTALLATION.html">Installation</a></li>
                <li><a href="EXAMPLES.html">Examples</a></li>
                <li><a href="API.html">API</a></li>
                <li><a href="https://github.com/openmaterials/pymks/">Github</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">More <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="THEORY.html">Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rst/derivation.html">Derivation of Materials Knowledge Systems Equation using Linear Elasticity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rst/CREDITS.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="rst/LICENSE.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="rst/CITATION.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="rst/REQUIREMENTS.html">Requirements</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="materials-knowledge-systems-in-python">
<h1>Materials Knowledge Systems in Python<a class="headerlink" href="#materials-knowledge-systems-in-python" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The Materials Knowledge Systems (MKS) is a novel data science approach
for solving multiscale materials science problems. It uses techniques
from machine learning, regression analysis, signal processing, and
spatial statistics to create structure-property-processing
relationships. The MKS carries the potential to both bridge multiple
length scales (using localization) and provide a framework for solving
the inverse material design problem.</p>
<p>See these references for further reading:</p>
<ul class="simple">
<li><em>Computationally-Efficient Fully-Coupled Multi-Scale Modeling of
Materials Phenomena Using Calibrated Localization Linkages</em>, S. R.
Kalidindi; ISRN Materials Science, vol. 2012, Article ID 305692,
2012,
<a class="reference external" href="http://dx.doi.org/10.5402/2012/305692">doi:10.5402/2012/305692</a>.</li>
<li><em>Formulation and Calibration of Higher-Order Elastic Localization
Relationships Using the MKS Approach</em>, Tony Fast and S. R. Kalidindi;
Acta Materialia, vol. 59 (11), pp. 4595-4605, 2011,
<a class="reference external" href="http://dx.doi.org/10.1016/j.actamat.2011.04.005">doi:10.1016/j.actamat.2011.04.005</a></li>
<li><em>Developing higher-order materials knowledge systems</em>, T. N. Fast;
Thesis (PhD, Materials engineering)&#8211;Drexel University, 2011,
<a class="reference external" href="http://dx.doi.org/1860/4057">doi:1860/4057</a>.</li>
</ul>
</div>
<div class="section" id="pymks">
<h2>PyMKS<a class="headerlink" href="#pymks" title="Permalink to this headline">¶</a></h2>
<p>The PyMKS framework is an object oriented set of tools and examples
written in Python that provides high level access to the MKS method for
rapid analysis of microstructure-property relationships. A description
of how to use PyMKS is outlined below and example cases can be found <a class="reference external" href="EXAMPLES.html">in
the examples section</a>. Both code and example
contributions are welcome.</p>
</div>
<div class="section" id="technical-overview">
<h2>Technical Overview<a class="headerlink" href="#technical-overview" title="Permalink to this headline">¶</a></h2>
<p>An important component of the MKS is the regression technique for rapid
calculation of a response field <span class="math">\(p\left[i\right]\)</span> based on a
microstructure <span class="math">\(m\left[i\right]\)</span>, where <span class="math">\(i\)</span> refers to a
discretized spatial location often in 2D or 3D and
<span class="math">\(\left[\cdot\right]\)</span> indicates a discrete argument over the
spatial domain. For example, the microstructure might represent values
of material properties that vary based on phase such as elastic modulus
or Poisson&#8217;s ratio while the response might be the stress or strain
field.</p>
<div class="section" id="discretize-in-state-space">
<h3>Discretize in State Space<a class="headerlink" href="#discretize-in-state-space" title="Permalink to this headline">¶</a></h3>
<p>The first step in the MKS is to bin (or discretize) the state space. To
do this, the microstructure <span class="math">\(m\)</span> is discretized and then
represented by <span class="math">\(m_h\)</span> such that</p>
<div class="math">
\[m\left[i\right] = \sum_{h=0}^{n-1} m_h\left[i\right] \chi_h\]</div>
<p>where <span class="math">\(\chi_h\)</span> is the basis representation for the microstructure
and <span class="math">\(n\)</span> is the number of states. For example if
<span class="math">\(m \left[i\right] = (0, 2, 1)\)</span>, and <span class="math">\(n=3\)</span>, then
<span class="math">\(\chi_h = (0, 1, 2)\)</span> and
<span class="math">\(m_h[i] = ((1, 0, 0), (0, 0, 1), (0, 1, 0))\)</span>. Thus,</p>
<div class="math">
\[m_h = \delta_{hm}\]</div>
<p>since the <span class="math">\(m\)</span>&#8216;s are just indices representing the state (the
<span class="math">\(\left[i\right]\)</span> has been dropped).</p>
</div>
<div class="section" id="the-influence-coefficients">
<h3>The Influence Coefficients<a class="headerlink" href="#the-influence-coefficients" title="Permalink to this headline">¶</a></h3>
<p>Once the state space is discretized, the relationship between the
response <span class="math">\(p\)</span> and microstructure <span class="math">\(m_h\)</span> can be written as,</p>
<div class="math">
\[p\left[i\right] = \sum_{h=0}^{n-1} \alpha_h\left[j\right] m_h\left[i - j\right]\]</div>
<p>where the <span class="math">\(\alpha_h\)</span> are known as the influence coefficients and
describe the relationship between <span class="math">\(p\)</span> and <span class="math">\(m_h\)</span>. The
<span class="math">\(p\)</span> are a spatial convolution of <span class="math">\(\alpha_h\)</span> and <span class="math">\(m_h\)</span>.
In general, it is assumed that both <span class="math">\(m_h\)</span> and <span class="math">\(p\)</span> are
periodic.</p>
<p>*** Note that the formulation above has dropped an index representing
the samples for simplicity. Generally the MKS is calibrated using many
samples. ***</p>
</div>
<div class="section" id="the-convolution">
<h3>The Convolution<a class="headerlink" href="#the-convolution" title="Permalink to this headline">¶</a></h3>
<p>The efficiency of the MKS is due to solving the linear regression in
Fourier space. For a 2D problem of size <span class="math">\(N^2\)</span>, the size of the
regression is reduced from
<span class="math">\(\left(N^2 N_{\text{sample}} \times N^2 H \right)\)</span> to
<span class="math">\(\left(N_{\text{sample}} \times H \right)\)</span> for each point in the
Fourier space of size <span class="math">\(N^2\)</span>. The convolution,</p>
<div class="math">
\[\sum_{h=0}^{n-1} \alpha_h\left[j\right] m_h \left[i - j\right]\]</div>
<p>can be deconvolved in Fourier space using the <a class="reference external" href="http://en.wikipedia.org/wiki/Discrete_Fourier_transform#Circular_convolution_theorem_and_cross-correlation_theorem">circular convolution
theorem</a>.</p>
<p>If we write
<span class="math">\(P \left[k \right] =  \mathcal{F}_k \{ p\left[i\right] \}\)</span>,
<span class="math">\(M_h \left[k\right]= \mathcal{F}_k  \{ m_h\left[i\right] \}\)</span> and
<span class="math">\(\beta\left[k\right] = \mathcal{F}_k \{  \alpha_h \left[i\right] \}\)</span>,
then we just need to solve</p>
<div class="math">
\[P\left[k\right] = \sum_{h=0}^{n-1} \beta_h \left[k\right] M_h \left[k\right]\]</div>
<p>with a linear regression at each discretization location in <span class="math">\(k\)</span> to
calculate the <span class="math">\(\beta_h\)</span>.</p>
<div class="section" id="note-about-notation">
<h4>Note about Notation<a class="headerlink" href="#note-about-notation" title="Permalink to this headline">¶</a></h4>
<p>Throughout PyMKS, the notation follows the signal processing convention
of using square brackets [] for discrete variables and round () brackets
for continuous variables. As an example, let <span class="math">\(x\)</span> be a continuous
variable and <span class="math">\(x_i\)</span> be a discrete value of <span class="math">\(x\)</span> at location
<span class="math">\(i\)</span>. Then the discrete and continuous version of a function
<span class="math">\(h\)</span> have the following relationship,</p>
<div class="math">
\[h[i] = h(x_i)\]</div>
<p>A discrete convolution also has an implied summation on repeated
indices,</p>
<div class="math">
\[h[i] = h(x_i) = \sum_j f(x_j) g(x_i - x_j) = \sum_j f[j] g[i - j] = f[j] g[i - j]\]</div>
</div>
</div>
</div>
<div class="section" id="a-pymks-example">
<h2>A PyMKS Example<a class="headerlink" href="#a-pymks-example" title="Permalink to this headline">¶</a></h2>
<p>One important application of the MKS is to accurately and rapidly
reproduce simulations for any given microstructure. In order to do this
we need to instantiate a <tt class="docutils literal"><span class="pre">MKSRegressionModel</span></tt> and calibrate the
influence coefficients using the <tt class="docutils literal"><span class="pre">fit</span></tt> method. Once the influence
coefficients have been calibrated, the <tt class="docutils literal"><span class="pre">predict</span></tt> method can be used to
quickly reproduce the same simulation for any microstructure. The rest
of the page will demonstrate how to do this for a finite element
simulation for linear elastic strain.</p>
</div>
<div class="section" id="linear-elasticity">
<h2>Linear Elasticity<a class="headerlink" href="#linear-elasticity" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s start by running a finite element simulation on a two phase random
microstructure with different elastic moduli. The
<tt class="docutils literal"><span class="pre">ElasticFESimulation</span></tt> class encapsulates the code needed to run a
plain strain problem using SfePy. It solves a plain strain problem on a
square domain by straining in the x-direction and applying periodic
boundary conditions in the y-direction. The two phase microstructure is
represented by <tt class="docutils literal"><span class="pre">X</span></tt>.</p>
<p>The <tt class="docutils literal"><span class="pre">make_elasticFEstrain_random</span></tt> function from <tt class="docutils literal"><span class="pre">pymks.datasets</span></tt>
provides a convenient interface to get random microstructures and their
strain fields using the <tt class="docutils literal"><span class="pre">ElasticFESimulation</span></tt> class. In this case we
are going to look at a 15 by 15 two phase microstructure with values of
elastic modulus values of 80 and 120. Both phases will have a Poisson&#8217;s
ratio of 0.3.</p>
<div class="code python highlight-python"><pre>%matplotlib inline
%load_ext autoreload
%autoreload 2

import numpy as np
import matplotlib.pyplot as plt</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.tools</span> <span class="kn">import</span> <span class="n">draw_microstructure_strain</span>
<span class="kn">from</span> <span class="nn">pymks.datasets</span> <span class="kn">import</span> <span class="n">make_elastic_FE_strain_random</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">strains</span> <span class="o">=</span> <span class="n">make_elastic_FE_strain_random</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">elastic_modulus</span><span class="o">=</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                           <span class="n">poissons_ratio</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="n">draw_microstructure_strain</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">strains</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<img alt="_images/intro_5_0.png" src="_images/intro_5_0.png" />
<div class="section" id="create-the-delta-microstructures">
<h3>Create the Delta Microstructures<a class="headerlink" href="#create-the-delta-microstructures" title="Permalink to this headline">¶</a></h3>
<p>The goal of the MKS it to quickly reproduce finite element simulations
like the one shown above. In the case of linear elasticity, which has
distinct phases, the MKS model can be calibrated with two delta
microstructures rather than hundreds of random microstructures. The
<tt class="docutils literal"><span class="pre">make_delta_microstructures</span></tt> function from <tt class="docutils literal"><span class="pre">pymks.datasets</span></tt> provides
a convenient interface to produce the delta microstructures.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.tools</span> <span class="kn">import</span> <span class="n">draw_microstructures</span>
<span class="kn">from</span> <span class="nn">pymks.datasets</span> <span class="kn">import</span> <span class="n">make_delta_microstructures</span>

<span class="n">X_delta</span> <span class="o">=</span> <span class="n">make_delta_microstructures</span><span class="p">(</span><span class="n">n_phases</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">draw_microstructures</span><span class="p">(</span><span class="n">X_delta</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_delta</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<img alt="_images/intro_7_0.png" src="_images/intro_7_0.png" />
</div>
<div class="section" id="create-the-responses">
<h3>Create the Responses<a class="headerlink" href="#create-the-responses" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">make_elasticFEstrain_delta</span></tt> function from the <tt class="docutils literal"><span class="pre">datasets</span></tt>
submodule of <tt class="docutils literal"><span class="pre">pymks</span></tt> returns both the delta microstructure and the
strain field. The strain fields and microstructures are used as inputs
to calibrate the influence coefficients.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.datasets</span> <span class="kn">import</span> <span class="n">make_elastic_FE_strain_delta</span>

<span class="n">X_delta</span><span class="p">,</span> <span class="n">strains_delta</span> <span class="o">=</span> <span class="n">make_elastic_FE_strain_delta</span><span class="p">(</span><span class="n">elastic_modulus</span><span class="o">=</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span>
                                                      <span class="n">poissons_ratio</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
                                                      <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="n">draw_microstructure_strain</span><span class="p">(</span><span class="n">X_delta</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">strains_delta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<img alt="_images/intro_9_0.png" src="_images/intro_9_0.png" />
</div>
<div class="section" id="calibrate-the-mks-model">
<h3>Calibrate the MKS Model<a class="headerlink" href="#calibrate-the-mks-model" title="Permalink to this headline">¶</a></h3>
<p>The first step is to calibrate the influence coefficients using the
microstructures and strain fields returned by
<tt class="docutils literal"><span class="pre">make_elasticFEstrain_delta</span></tt>. The <tt class="docutils literal"><span class="pre">MKSRegressionModel</span></tt> calibrates
the model in the <tt class="docutils literal"><span class="pre">fit</span></tt> method. A <tt class="docutils literal"><span class="pre">DiscreteIndicatorBasis</span></tt> is needed
to discretize the microstructure before passing it to the <tt class="docutils literal"><span class="pre">fit</span></tt>
method.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks</span> <span class="kn">import</span> <span class="n">MKSRegressionModel</span>
<span class="kn">from</span> <span class="nn">pymks.bases</span> <span class="kn">import</span> <span class="n">DiscreteIndicatorBasis</span>

<span class="n">basis</span> <span class="o">=</span> <span class="n">DiscreteIndicatorBasis</span><span class="p">(</span><span class="n">n_states</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">X_delta</span><span class="p">,</span> <span class="n">y_delta</span> <span class="o">=</span> <span class="n">X_delta</span><span class="p">,</span> <span class="n">strains_delta</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MKSRegressionModel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">basis</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_delta</span><span class="p">,</span> <span class="n">y_delta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="reproduce-the-finite-element-simulation">
<h3>Reproduce the Finite Element Simulation<a class="headerlink" href="#reproduce-the-finite-element-simulation" title="Permalink to this headline">¶</a></h3>
<p>Now that the influence coefficients have been calibrated using the
<tt class="docutils literal"><span class="pre">fit</span></tt> method, the original finite element simulation can be reproduced
using the <tt class="docutils literal"><span class="pre">MKSRegressionmModel</span></tt> by passing the original microstructure
into the <tt class="docutils literal"><span class="pre">predict</span></tt> method.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.tools</span> <span class="kn">import</span> <span class="n">draw_strains_compare</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">X</span><span class="p">,</span> <span class="n">strains</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">draw_strains_compare</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</pre></div>
</div>
<img alt="_images/intro_13_0.png" src="_images/intro_13_0.png" />
<p>The <tt class="docutils literal"><span class="pre">MKSRegressionModel</span></tt> has done quite a good job of predicting the
results from the original FE simulation after calibrating the influence
coefficients using delta microstructures.</p>
</div>
<div class="section" id="comments">
<h3>Comments<a class="headerlink" href="#comments" title="Permalink to this headline">¶</a></h3>
<p>The MKS coefficients can then be scaled up to reproduce larger FE
simulations using only the small FE simulation to seed the MKS model.</p>
<div class="toctree-wrapper compound">
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>