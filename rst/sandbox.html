

<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>&lt;no title&gt; &mdash; PyMKS</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.1.0/cosmo/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pymks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/pymks_logo.ico"/>
    <link rel="top" title="PyMKS" href="../index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/pymks_logo.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.1-dev</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="INSTALLATION.html">Installation</a></li>
                <li><a href="../EXAMPLES.html">Examples</a></li>
                <li><a href="../API.html">API</a></li>
                <li><a href="https://github.com/openmaterials/pymks/">Github</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">More <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../THEORY.html">Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="derivation.html">Derivation of Materials Knowledge Systems Equation using Linear Elasticity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="CREDITS.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="LICENSE.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="CITATION.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="REQUIREMENTS.html">Requirements</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="code python highlight-python"><pre>%matplotlib inline
%load_ext autoreload
%autoreload 2</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.datasets.microstructureGenerator</span> <span class="kn">import</span> <span class="n">MicrostructureGenerator</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">MicrostructureGenerator</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span> <span class="n">n_phases</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">grain_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.image.AxesImage at 0x7ffc7ce264d0&gt;</pre>
</div>
<img alt="../_images/sandbox_1_1.png" src="../_images/sandbox_1_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks</span> <span class="kn">import</span> <span class="n">SpatialStatisticsModel</span>
<span class="kn">from</span> <span class="nn">pymks</span> <span class="kn">import</span> <span class="n">MKSRegressionModel</span>
<span class="kn">from</span> <span class="nn">pymks.bases</span> <span class="kn">import</span> <span class="n">DiscreteIndicatorBasis</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">basis</span> <span class="o">=</span> <span class="n">DiscreteIndicatorBasis</span><span class="p">(</span><span class="n">n_states</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">MKSmodel</span> <span class="o">=</span> <span class="n">MKSRegressionModel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">basis</span><span class="p">)</span>
<span class="n">SpatStats</span> <span class="o">=</span> <span class="n">SpatialStatisticsModel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.datasets.microstructureGenerator</span> <span class="kn">import</span> <span class="n">get_microstructure</span>

<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">31</span>
<span class="n">n_phases</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">get_microstructure</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">n_phases</span><span class="p">)</span>
<span class="k">print</span> <span class="n">X</span><span class="o">.</span><span class="n">dtype</span>
<span class="n">X_auto</span> <span class="o">=</span> <span class="n">SpatStats</span><span class="o">.</span><span class="n">get_autocorrelation</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="k">print</span> <span class="n">X_auto</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">int32</span>
<span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;none&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.image.AxesImage at 0xac1b904c&gt;</pre>
</div>
<img alt="../_images/sandbox_5_1.png" src="../_images/sandbox_5_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_auto</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X_auto</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">82.4162330905</span>
</pre></div>
</div>
<img alt="../_images/sandbox_6_1.png" src="../_images/sandbox_6_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_auto</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.colorbar.Colorbar instance at 0xac07726c&gt;</pre>
</div>
<img alt="../_images/sandbox_7_1.png" src="../_images/sandbox_7_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]])</span>
<span class="n">X_auto</span> <span class="o">=</span> <span class="n">SpatStats</span><span class="o">.</span><span class="n">get_autocorrelation</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="k">print</span> <span class="n">X_auto</span>
</pre></div>
</div>
<div class="highlight-python"><pre>(1, 3, 3, 2)
[1 2]
[[[[  1.66666667e-01  -3.28954970e-17]
   [  1.66666667e-01  -3.28954970e-17]
   [  3.33333333e-01   1.66666667e-01]]

  [[  1.66666667e-01  -3.28954970e-17]
   [  1.66666667e-01  -3.28954970e-17]
   [  3.33333333e-01   1.66666667e-01]]

  [[  1.66666667e-01  -3.28954970e-17]
   [  1.66666667e-01  -3.28954970e-17]
   [  3.33333333e-01   1.66666667e-01]]]]</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_auto</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">X_auto</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><pre>/home/david/anaconda/lib/python2.7/site-packages/matplotlib/colorbar.py:829: RuntimeWarning: divide by zero encountered in divide
  z = np.take(y, i0) + (xn - np.take(b, i0)) * dy / db</pre>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.colorbar.Colorbar instance at 0xabe808cc&gt;</pre>
</div>
<img alt="../_images/sandbox_9_2.png" src="../_images/sandbox_9_2.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.datasets.microstructureGenerator</span> <span class="kn">import</span> <span class="n">microstructure_generator</span>

<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">n_phases</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">microstructure_generator</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">n_phases</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.image.AxesImage at 0xa88894ec&gt;</pre>
</div>
<img alt="../_images/sandbox_10_1.png" src="../_images/sandbox_10_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.datasets.microstructureGenerator</span> <span class="kn">import</span> <span class="n">get_microstructure</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">n_samples</span><span class="p">,</span> <span class="n">n_phases</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="c">#n_samples = 1</span>
<span class="c">#n = 3</span>
<span class="c">#n_phases = 2</span>
<span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">get_microstructure</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">n_phases</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
 <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">],</span>
 <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">]])</span>
<span class="c">#plt.imshow(X[0], interpolation=&#39;none&#39;)</span>
<span class="c">#print X[0]</span>
<span class="k">assert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X_test</span><span class="p">))</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">X_cum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_cum</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[&lt;matplotlib.lines.Line2D at 0xa1e310ec&gt;]</pre>
</div>
<img alt="../_images/sandbox_12_1.png" src="../_images/sandbox_12_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">m</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">m</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
<span class="k">print</span> <span class="n">values</span>
<span class="k">print</span> <span class="n">X_cum</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[   0.   33.   67.  100.]
208233407.661</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">normalization</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">normalization</span> <span class="p">,</span> <span class="n">normalization</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="c">#plt.plot(norm.pdf(x1))</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="n">normalization</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="n">normalization</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y1</span><span class="p">))</span>
<span class="c">#plt.plot(y1)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><pre>---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

&lt;ipython-input-208-f3c2db246b68&gt; in &lt;module&gt;()
      9 print(np.max(y1))
     10 #plt.plot(y1)
---&gt; 11 plt.imshow(np.outer(y1, y1, y1))
     12 plt.colorbar()


TypeError: outer() takes exactly 2 arguments (3 given)</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">0.961957416885</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">y3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.colorbar.Colorbar instance at 0x20158950&gt;</pre>
</div>
<img alt="../_images/sandbox_15_1.png" src="../_images/sandbox_15_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">121</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="n">xp1</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="p">((</span><span class="n">L</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">xp2</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="p">((</span><span class="n">L</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">print</span> <span class="n">xp</span>
<span class="n">ga1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">L</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">L</span> <span class="o">/</span> <span class="mf">8.</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="c">#ga2 = np.exp(-(xp2 / ((L) / 4.2)) ** 2)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">gaussian</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span>
<span class="c">#ga = ga1 * ga2</span>
<span class="c">#print q</span>
<span class="c">#print ga</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ga1</span><span class="p">)</span>
<span class="c">#plt.plot(ga1)</span>
<span class="c">#plt.plot(ga2)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[-5 -4 -3 -2 -1  0  1  2  3  4]</pre>
</div>
<div class="highlight-python"><pre>[&lt;matplotlib.lines.Line2D at 0xa2ffe3ac&gt;]</pre>
</div>
<img alt="../_images/sandbox_16_2.png" src="../_images/sandbox_16_2.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">gaussian</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">gaussian</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">dim</span> <span class="o">=</span> <span class="mi">3</span>
<span class="k">print</span> <span class="n">dim</span> <span class="o">*</span> <span class="p">(</span><span class="n">L</span><span class="p">,)</span>
<span class="n">gaussian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">dim</span> <span class="o">*</span> <span class="p">(</span><span class="n">L</span><span class="p">,))</span> <span class="o">*</span> <span class="n">gaussian</span>
<span class="n">gaussian_tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">dim</span><span class="p">,)</span> <span class="o">+</span> <span class="n">gaussian</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
    <span class="n">gaussian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">gaussian</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">dim</span><span class="p">)</span>
    <span class="n">gaussian_tmp</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">gaussian</span>
<span class="n">gaussian_filter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">gaussian_tmp</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gaussian_filter</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.colorbar.Colorbar instance at 0xab845d6c&gt;</pre>
</div>
<img alt="../_images/sandbox_17_2.png" src="../_images/sandbox_17_2.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">1</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)]</span>

<span class="c">#print Qf.shape</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">ons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">))</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">ons</span> <span class="o">*</span> <span class="n">q</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.image.AxesImage at 0xad67fbcc&gt;</pre>
</div>
<img alt="../_images/sandbox_19_1.png" src="../_images/sandbox_19_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="c">#from scipy.stats import multivariate_normal</span>
<span class="kn">from</span> <span class="nn">scipy.stats.multivariate_normal</span> <span class="kn">import</span> <span class="n">multivariate_normal</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="k">print</span> <span class="n">y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)

&lt;ipython-input-279-ac485fe001c8&gt; in &lt;module&gt;()
      1 #from scipy.stats import multivariate_normal
----&gt; 2 from scipy.stats.multivariate_normal import multivariate_normal
      3
      4 x = np.linspace(0, 5, 10, endpoint=False)
      5 y = mn.pdf(x, mean=2.5, cov=0.5)


ImportError: No module named multivariate_normal</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">values</span><span class="p">,</span> <span class="n">base</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="c">#evaluate the cumulative</span>
<span class="n">cumulative</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="c"># plot the cumulative function</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">base</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">cumulative</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">)</span>
<span class="c">#plot the survival function</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">base</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">-</span><span class="n">cumulative</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[&lt;matplotlib.lines.Line2D at 0xb82a290&gt;]</pre>
</div>
<img alt="../_images/sandbox_21_1.png" src="../_images/sandbox_21_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">L</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span> <span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">L</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">-</span> <span class="n">L</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">mesh_size</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">))]</span>

<span class="k">print</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
<span class="n">Ones</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">))</span> <span class="o">*</span> <span class="n">y</span>
<span class="k">print</span> <span class="n">Ones</span>

<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">ii</span>
    <span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Ones</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">Ones</span> <span class="o">=</span> <span class="n">Ones</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Ones</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">print</span> <span class="n">Ones</span>
<span class="c">#print mesh_size</span>
<span class="c">#print mesh_size[0]</span>
<span class="c">#np.meshgrid(mesh_size)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>(3,)
[[[ 0.  1.  0.]
  [ 0.  1.  0.]
  [ 0.  1.  0.]]

 [[ 0.  1.  0.]
  [ 0.  1.  0.]
  [ 0.  1.  0.]]

 [[ 0.  1.  0.]
  [ 0.  1.  0.]
  [ 0.  1.  0.]]]
0</pre>
</div>
<div class="highlight-python"><pre>---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)

&lt;ipython-input-153-e1fadf94a7c0&gt; in &lt;module&gt;()
     11 for ii in range(len(X.shape) - 1):
     12     print ii
---&gt; 13     print np.transpose(Ones, axes=(ii + 1))
     14     Ones = Ones * np.transpose(Ones, axes=ii + 1)
     15 print Ones


/home/david/anaconda/lib/python2.7/site-packages/numpy/core/fromnumeric.pyc in transpose(a, axes)
    532     except AttributeError:
    533         return _wrapit(a, 'transpose', axes)
--&gt; 534     return transpose(axes)
    535
    536


ValueError: axes don't match array</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">k</span><span class="p">[</span><span class="n">N</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="n">N</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)[:</span><span class="n">N</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
<span class="k">print</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="n">N</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)[:</span><span class="n">N</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="o">-</span><span class="mi">10</span>  <span class="o">-</span><span class="mi">9</span>  <span class="o">-</span><span class="mi">8</span>  <span class="o">-</span><span class="mi">7</span>  <span class="o">-</span><span class="mi">6</span>  <span class="o">-</span><span class="mi">5</span>  <span class="o">-</span><span class="mi">4</span>  <span class="o">-</span><span class="mi">3</span>  <span class="o">-</span><span class="mi">2</span>  <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><pre>          X = np.array([[[0, 1, 0],
               [0, 1, 0],
               [0, 1, 0]]])
print X.shape
print np.array(X.shape)
y = np.array(X.shape)
print np.prod(y)
X_ = basis.discretize(X)
print SpatStats._fftconvolve(X_, X_)
C = SpatStats.Autocorrelation(X)
np.real_if_close(np.where(C &lt; 1e-10, 0, C))</pre>
</div>
<div class="highlight-python"><pre>(1, 3, 3)
[1 3 3]
9
[[[[  5.00000000e-01+0.j  -1.31581988e-16+0.j]
   [  1.66666667e-01+0.j   3.33333333e-01+0.j]
   [  1.66666667e-01+0.j   3.33333333e-01+0.j]]

  [[  5.00000000e-01+0.j  -1.31581988e-16+0.j]
   [  1.66666667e-01+0.j   3.33333333e-01+0.j]
   [  1.66666667e-01+0.j   3.33333333e-01+0.j]]

  [[  5.00000000e-01+0.j  -1.31581988e-16+0.j]
   [  1.66666667e-01+0.j   3.33333333e-01+0.j]
   [  1.66666667e-01+0.j   3.33333333e-01+0.j]]]]</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[[[</span> <span class="mf">0.5</span>       <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">],</span>
         <span class="p">[</span> <span class="mf">0.16666667</span><span class="p">,</span>  <span class="mf">0.33333333</span><span class="p">],</span>
         <span class="p">[</span> <span class="mf">0.16666667</span><span class="p">,</span>  <span class="mf">0.33333333</span><span class="p">]],</span>

        <span class="p">[[</span> <span class="mf">0.5</span>       <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">],</span>
         <span class="p">[</span> <span class="mf">0.16666667</span><span class="p">,</span>  <span class="mf">0.33333333</span><span class="p">],</span>
         <span class="p">[</span> <span class="mf">0.16666667</span><span class="p">,</span>  <span class="mf">0.33333333</span><span class="p">]],</span>

        <span class="p">[[</span> <span class="mf">0.5</span>       <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">],</span>
         <span class="p">[</span> <span class="mf">0.16666667</span><span class="p">,</span>  <span class="mf">0.33333333</span><span class="p">],</span>
         <span class="p">[</span> <span class="mf">0.16666667</span><span class="p">,</span>  <span class="mf">0.33333333</span><span class="p">]]]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.datasets.microstructureGenerator</span> <span class="kn">import</span> <span class="n">microstructure_generator</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">microstructure_generator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-python"><pre>/home/david/anaconda/lib/python2.7/site-packages/numpy/core/numeric.py:178: DeprecationWarning: using a non-integer number instead of an integer will result in an error in the future
  a = empty(shape, dtype, order)</pre>
</div>
<div class="highlight-python"><pre>---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)

&lt;ipython-input-19-442a14176a6a&gt; in &lt;module&gt;()
----&gt; 1 microstructure_generator(np.zeros((5, 5)))


/home/david/git/pymks/pymks/datasets/microstructureGenerator.py in microstructure_generator(X)
      4
      5 def microstructure_generator(X):
----&gt; 6     _make_filter(X)
      7
      8


/home/david/git/pymks/pymks/datasets/microstructureGenerator.py in _make_filter(X)
     10     shape = np.array(X[0].shape) / 4.
     11     filt = np.zeros_like(X[0].shape)
---&gt; 12     filt[:np.split(shape, len(shape))] = np.ones(shape)
     13     print filt
     14


IndexError: invalid slice</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">print</span> <span class="n">X</span>

<span class="n">MSf</span> <span class="o">=</span> <span class="n">MicrostructureFunction</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">MSf</span><span class="o">.</span><span class="n">_Legendre</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[[ 0.          0.33333333]
 [ 0.66666667  1.        ]]</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[[</span><span class="o">-</span><span class="mf">3.5</span>       <span class="p">,</span>  <span class="mf">2.5</span>       <span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span>       <span class="p">,</span>  <span class="mf">0.5</span>       <span class="p">],</span>
        <span class="p">[</span> <span class="mf">1.42592593</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.83333333</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span>       <span class="p">,</span>  <span class="mf">0.5</span>       <span class="p">]],</span>

       <span class="p">[[</span><span class="o">-</span><span class="mf">1.42592593</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.83333333</span><span class="p">,</span>  <span class="mf">0.5</span>       <span class="p">,</span>  <span class="mf">0.5</span>       <span class="p">],</span>
        <span class="p">[</span> <span class="mf">3.5</span>       <span class="p">,</span>  <span class="mf">2.5</span>       <span class="p">,</span>  <span class="mf">1.5</span>       <span class="p">,</span>  <span class="mf">0.5</span>       <span class="p">]]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">X0</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span>
<span class="k">print</span> <span class="n">X0</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[ 0.5  1.5  2.5  3.5]</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">MSf</span><span class="o">.</span><span class="n">_Legendre_fft</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[0 1]</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[[</span>  <span class="mf">0.00000000e+00</span><span class="o">+</span><span class="mf">0.j</span><span class="p">,</span>   <span class="mf">3.33333333e+00</span><span class="o">+</span><span class="mf">0.j</span><span class="p">,</span>   <span class="mf">0.00000000e+00</span><span class="o">+</span><span class="mf">0.j</span><span class="p">,</span>
           <span class="mf">2.00000000e+00</span><span class="o">+</span><span class="mf">0.j</span><span class="p">],</span>
        <span class="p">[</span> <span class="o">-</span><span class="mf">9.85185185e+00</span><span class="o">+</span><span class="mf">0.j</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.44089210e-16</span><span class="o">+</span><span class="mf">0.j</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.00000000e+00</span><span class="o">+</span><span class="mf">0.j</span><span class="p">,</span>
           <span class="mf">0.00000000e+00</span><span class="o">+</span><span class="mf">0.j</span><span class="p">]],</span>

       <span class="p">[[</span> <span class="o">-</span><span class="mf">4.14814815e+00</span><span class="o">+</span><span class="mf">0.j</span><span class="p">,</span>   <span class="mf">2.22044605e-16</span><span class="o">+</span><span class="mf">0.j</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.00000000e+00</span><span class="o">+</span><span class="mf">0.j</span><span class="p">,</span>
           <span class="mf">0.00000000e+00</span><span class="o">+</span><span class="mf">0.j</span><span class="p">],</span>
        <span class="p">[</span>  <span class="mf">0.00000000e+00</span><span class="o">+</span><span class="mf">0.j</span><span class="p">,</span>   <span class="mf">6.66666667e+00</span><span class="o">+</span><span class="mf">0.j</span><span class="p">,</span>   <span class="mf">0.00000000e+00</span><span class="o">+</span><span class="mf">0.j</span><span class="p">,</span>
           <span class="mf">0.00000000e+00</span><span class="o">+</span><span class="mf">0.j</span><span class="p">]]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">3.</span> <span class="o">*</span> <span class="n">X</span>
<span class="k">print</span> <span class="n">y</span>
<span class="k">print</span> <span class="n">X</span>

<span class="n">LR</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>

<span class="n">LR</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;coeff&#39;</span><span class="p">,</span> <span class="n">LR</span><span class="o">.</span><span class="n">coef_</span>
<span class="k">print</span> <span class="s">&#39;Intercept&#39;</span><span class="p">,</span><span class="n">LR</span><span class="o">.</span><span class="n">intercept_</span>
<span class="n">LR</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[[ 3.  6.]
 [ 0.  3.]]
[[ 1.  2.]
 [ 0.  1.]]
coeff [[ 1.5  1.5]
 [ 1.5  1.5]]
Intercept [-1.5  1.5]</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span>  <span class="mf">3.00000000e+00</span><span class="p">,</span>   <span class="mf">6.00000000e+00</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">6.66133815e-16</span><span class="p">,</span>   <span class="mf">3.00000000e+00</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="kn">as</span> <span class="nn">mlab</span>
<span class="n">num_bins</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="mi">101</span><span class="p">))</span>
<span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c"># add a &#39;best fit&#39; line</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">normpdf</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&#39;r--&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)

&lt;ipython-input-19-6b080d0ab04d&gt; in &lt;module&gt;()
      6 n, bins, patches = plt.hist(X, num_bins, normed=1, facecolor='green', alpha=0.5)
      7 # add a 'best fit' line
----&gt; 8 y = mlab.normpdf(bins, mu, sigma)
      9 plt.plot(bins, y, 'r--')


AttributeError: 'module' object has no attribute 'normpdf'</pre>
</div>
<img alt="../_images/sandbox_31_1.png" src="../_images/sandbox_31_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">X</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>([array([  0.,   0.,   4.,  16.,  25.,  27.,  23.,   5.,   1.,   0.]),
  array([  0.,   0.,   2.,   8.,  22.,  29.,  29.,   8.,   3.,   0.]),
  array([  1.,   0.,   3.,  10.,  24.,  29.,  23.,   7.,   3.,   1.]),
  array([  0.,   0.,   3.,  17.,  25.,  25.,  18.,  12.,   1.,   0.]),
  array([  0.,   0.,   4.,  13.,  17.,  33.,  27.,   6.,   1.,   0.]),
  array([  0.,   0.,   4.,  13.,  25.,  31.,  19.,   7.,   2.,   0.]),
  array([  1.,   1.,   5.,   6.,  25.,  30.,  22.,   9.,   2.,   0.]),
  array([  0.,   1.,   6.,   8.,  30.,  29.,  14.,  11.,   2.,   0.]),
  array([  0.,   0.,   3.,   9.,  23.,  34.,  26.,   6.,   0.,   0.]),
  array([  0.,   1.,   3.,  11.,  28.,  29.,  16.,  10.,   1.,   2.]),
  array([  0.,   0.,   6.,  12.,  22.,  33.,  17.,   8.,   2.,   1.]),
  array([  0.,   1.,   5.,  12.,  18.,  28.,  24.,  10.,   2.,   1.]),
  array([  0.,   0.,   6.,  10.,  25.,  27.,  24.,   8.,   1.,   0.]),
  array([  0.,   2.,   4.,  13.,  21.,  25.,  21.,  13.,   1.,   1.]),
  array([  0.,   0.,   2.,  11.,  18.,  37.,  20.,  12.,   1.,   0.]),
  array([  0.,   0.,   2.,  11.,  35.,  21.,  20.,  11.,   1.,   0.]),
  array([  0.,   0.,   3.,   9.,  26.,  29.,  21.,   7.,   6.,   0.]),
  array([  0.,   1.,   5.,  10.,  19.,  30.,  23.,  10.,   2.,   1.]),
  array([  0.,   0.,   1.,   9.,  32.,  30.,  19.,   6.,   4.,   0.]),
  array([  0.,   0.,   5.,  13.,  25.,  31.,  18.,   4.,   4.,   1.]),
  array([  0.,   0.,   4.,  10.,  30.,  22.,  24.,   8.,   2.,   1.]),
  array([  0.,   1.,   5.,   9.,  29.,  28.,  20.,   6.,   3.,   0.]),
  array([  0.,   0.,   1.,   7.,  27.,  25.,  27.,  10.,   4.,   0.]),
  array([  0.,   0.,   2.,   8.,  30.,  29.,  18.,   9.,   5.,   0.]),
  array([  0.,   0.,   7.,  13.,  23.,  27.,  26.,   4.,   1.,   0.]),
  array([  0.,   0.,   2.,  11.,  28.,  19.,  29.,   9.,   3.,   0.]),
  array([  0.,   1.,   4.,   8.,  22.,  32.,  23.,   7.,   3.,   1.]),
  array([  0.,   0.,   3.,  13.,  24.,  30.,  24.,   6.,   1.,   0.]),
  array([  0.,   2.,   3.,  15.,  24.,  21.,  26.,  10.,   0.,   0.]),
  array([  0.,   0.,   5.,  16.,  26.,  20.,  26.,   7.,   1.,   0.]),
  array([  0.,   1.,   4.,  17.,  22.,  25.,  21.,   9.,   2.,   0.]),
  array([  0.,   1.,   2.,  13.,  25.,  31.,  19.,   7.,   2.,   1.]),
  array([  0.,   0.,   2.,  15.,  19.,  23.,  22.,  17.,   2.,   1.]),
  array([  0.,   0.,   1.,  17.,  24.,  33.,  20.,   5.,   1.,   0.]),
  array([  0.,   0.,   6.,   9.,  30.,  31.,  15.,  10.,   0.,   0.]),
  array([  0.,   0.,   5.,  15.,  24.,  19.,  31.,   5.,   1.,   1.]),
  array([  0.,   1.,   5.,   6.,  27.,  30.,  21.,  10.,   0.,   1.]),
  array([  0.,   0.,   2.,  16.,  25.,  34.,  18.,   5.,   1.,   0.]),
  array([  0.,   0.,   5.,  19.,  24.,  25.,  17.,   8.,   2.,   1.]),
  array([  0.,   1.,   5.,  15.,  16.,  28.,  24.,   8.,   4.,   0.]),
  array([  0.,   0.,   1.,  12.,  16.,  32.,  24.,  11.,   5.,   0.]),
  array([  0.,   0.,   1.,   7.,  28.,  29.,  23.,  13.,   0.,   0.]),
  array([  0.,   0.,   3.,  11.,  21.,  35.,  19.,  11.,   1.,   0.]),
  array([  0.,   0.,   5.,  13.,  24.,  26.,  21.,  11.,   1.,   0.]),
  array([  0.,   0.,   0.,  11.,  20.,  34.,  18.,  15.,   2.,   1.]),
  array([  0.,   0.,   4.,  17.,  17.,  35.,  21.,   5.,   2.,   0.]),
  array([  0.,   1.,   4.,  10.,  24.,  28.,  21.,  10.,   2.,   1.]),
  array([  0.,   2.,   2.,  13.,  19.,  28.,  22.,  13.,   2.,   0.]),
  array([  0.,   2.,   2.,  12.,  18.,  32.,  19.,  13.,   3.,   0.]),
  array([  0.,   1.,   6.,  10.,  22.,  31.,  15.,  14.,   2.,   0.]),
  array([  0.,   0.,   1.,   9.,  23.,  36.,  20.,  12.,   0.,   0.]),
  array([  0.,   0.,   2.,  14.,  30.,  34.,  11.,   7.,   3.,   0.]),
  array([  0.,   1.,   1.,   8.,  31.,  30.,  17.,  11.,   1.,   1.]),
  array([  0.,   0.,   3.,  19.,  21.,  33.,  18.,   6.,   1.,   0.]),
  array([  0.,   0.,   3.,  12.,  29.,  22.,  25.,   5.,   5.,   0.]),
  array([  0.,   1.,   2.,   9.,  25.,  25.,  22.,   9.,   8.,   0.]),
  array([  0.,   2.,   6.,  13.,  25.,  26.,  17.,  10.,   1.,   1.]),
  array([  1.,   0.,   4.,  12.,  20.,  28.,  27.,   8.,   1.,   0.]),
  array([  0.,   0.,   1.,  13.,  18.,  42.,  19.,   5.,   2.,   1.]),
  array([  0.,   0.,   5.,   7.,  20.,  28.,  23.,  15.,   3.,   0.]),
  array([  0.,   0.,   2.,  15.,  23.,  30.,  19.,   9.,   2.,   1.]),
  array([  0.,   0.,   2.,  15.,  22.,  33.,  16.,  11.,   1.,   1.]),
  array([  0.,   2.,   5.,  15.,  24.,  23.,  20.,  10.,   1.,   1.]),
  array([  0.,   1.,   4.,  10.,  26.,  32.,  17.,   9.,   2.,   0.]),
  array([  0.,   0.,   4.,  13.,  22.,  33.,  19.,   9.,   1.,   0.]),
  array([  1.,   0.,   0.,  14.,  25.,  28.,  22.,   8.,   3.,   0.]),
  array([  0.,   0.,   4.,  11.,  22.,  36.,  20.,   6.,   2.,   0.]),
  array([  1.,   1.,   6.,   4.,  31.,  31.,  17.,   9.,   1.,   0.]),
  array([  0.,   1.,   1.,  11.,  19.,  30.,  15.,  16.,   8.,   0.]),
  array([  0.,   1.,   2.,  10.,  29.,  23.,  26.,   6.,   4.,   0.]),
  array([  0.,   1.,   2.,  10.,  22.,  34.,  18.,  10.,   4.,   0.]),
  array([  0.,   2.,   1.,   9.,  15.,  28.,  29.,  14.,   3.,   0.]),
  array([  0.,   1.,   1.,  15.,  21.,  26.,  21.,  11.,   5.,   0.]),
  array([  0.,   0.,   5.,  13.,  22.,  29.,  20.,   9.,   3.,   0.]),
  array([  0.,   1.,   4.,  15.,  19.,  36.,  18.,   8.,   0.,   0.]),
  array([  0.,   0.,   5.,   8.,  21.,  34.,  23.,   8.,   1.,   1.]),
  array([  1.,   1.,   4.,  12.,  21.,  34.,  17.,  10.,   0.,   1.]),
  array([  1.,   0.,   3.,  14.,  31.,  32.,  12.,   3.,   5.,   0.]),
  array([  0.,   0.,   4.,   9.,  27.,  27.,  22.,   9.,   3.,   0.]),
  array([  0.,   0.,   3.,  10.,  28.,  33.,  19.,   7.,   1.,   0.]),
  array([  0.,   1.,   1.,  10.,  30.,  24.,  20.,  13.,   2.,   0.]),
  array([  0.,   1.,   3.,   8.,  23.,  32.,  25.,   7.,   2.,   0.]),
  array([  0.,   0.,   4.,  10.,  24.,  37.,  18.,   7.,   1.,   0.]),
  array([  0.,   0.,   6.,  15.,  16.,  38.,  19.,   6.,   1.,   0.]),
  array([  0.,   0.,   4.,   9.,  30.,  30.,  20.,   5.,   3.,   0.]),
  array([  0.,   0.,   2.,  12.,  29.,  29.,  19.,   8.,   2.,   0.]),
  array([  0.,   0.,   3.,  10.,  17.,  40.,  15.,  13.,   3.,   0.]),
  array([  0.,   1.,   5.,  15.,  27.,  26.,  16.,   9.,   2.,   0.]),
  array([  1.,   0.,   3.,  10.,  23.,  27.,  21.,  12.,   3.,   1.]),
  array([  0.,   0.,   5.,  17.,  19.,  28.,  15.,  12.,   5.,   0.]),
  array([  0.,   0.,   2.,  16.,  19.,  27.,  19.,  16.,   2.,   0.]),
  array([  0.,   0.,   7.,  11.,  21.,  29.,  21.,  10.,   1.,   1.]),
  array([  0.,   0.,   3.,   6.,  21.,  37.,  26.,   4.,   3.,   1.]),
  array([  0.,   1.,   3.,  10.,  30.,  21.,  24.,   9.,   2.,   1.]),
  array([  0.,   0.,   4.,   9.,  17.,  30.,  29.,  10.,   2.,   0.]),
  array([  0.,   0.,   3.,  10.,  16.,  36.,  22.,  11.,   3.,   0.]),
  array([  0.,   0.,   4.,  14.,  16.,  33.,  21.,  12.,   1.,   0.]),
  array([  0.,   0.,   3.,   9.,  25.,  30.,  21.,   9.,   4.,   0.]),
  array([  0.,   0.,   3.,  15.,  17.,  41.,  12.,  10.,   3.,   0.]),
  array([  0.,   2.,   5.,   8.,  22.,  31.,  22.,   9.,   1.,   1.]),
  array([  0.,   0.,   7.,  10.,  24.,  25.,  23.,  10.,   2.,   0.])],
 array([-1.51570331, -1.13944486, -0.76318642, -0.38692797, -0.01066952,
         0.36558892,  0.74184737,  1.11810582,  1.49436427,  1.87062271,
         2.24688116]),
 &lt;a list of 101 Lists of Patches objects&gt;)</pre>
</div>
<img alt="../_images/sandbox_32_1.png" src="../_images/sandbox_32_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">_getProp</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">E1</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">nu1</span><span class="p">,</span> <span class="n">nu2</span><span class="p">):</span>
    <span class="n">X_prop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="p">,))</span>
    <span class="n">X_prop</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">E1</span><span class="p">,</span> <span class="n">E2</span><span class="p">)</span>
    <span class="n">X_prop</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nu1</span><span class="p">,</span> <span class="n">nu2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">X_prop</span>

<span class="k">def</span> <span class="nf">getPlot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;title&#39;</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">getPlots</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">yMKS</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="n">getPlot</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s">&#39;FE&#39;</span><span class="p">)</span>
    <span class="n">getPlot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">yMKS</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span><span class="s">&#39;MKS Absolute </span><span class="si">% E</span><span class="s">rror&#39;</span><span class="p">)</span>
    <span class="n">getPlot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">coeff</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s">&#39;Coeff0&#39;</span><span class="p">)</span>
    <span class="c">#getPlot(model.coeff[...,1],&#39;Coeff1&#39;)</span>

<span class="k">def</span> <span class="nf">getDel</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">Del</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">))</span>
    <span class="n">Del</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">C</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">Del</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Del</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Del</span>

<span class="k">def</span> <span class="nf">getProp</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="n">E1</span> <span class="o">=</span> <span class="mi">80</span>
    <span class="n">E2</span> <span class="o">=</span> <span class="mi">120</span>
    <span class="n">nu1</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="n">nu2</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="k">return</span> <span class="n">_getProp</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">E1</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">nu1</span><span class="p">,</span> <span class="n">nu2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">getRand</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">getCoeffplots</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
    <span class="n">getPlot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">coeff</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s">&#39;Coeff0&#39;</span><span class="p">)</span>
    <span class="c">#getPlot(model.coeff[...,1],&#39;Coeff1&#39;)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">L</span> <span class="o">=</span> <span class="mi">12</span>

<span class="n">Del</span> <span class="o">=</span> <span class="n">getDel</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="n">FEmodel</span> <span class="o">=</span> <span class="n">ElasticFEModel</span><span class="p">()</span>
<span class="n">MKSmodel</span> <span class="o">=</span> <span class="n">MKSRegressionModel</span><span class="p">(</span><span class="n">Nbin</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">MKSmodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Del</span><span class="p">,</span> <span class="n">FEmodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">getProp</span><span class="p">(</span><span class="n">Del</span><span class="p">))[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">getRand</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">FEmodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">getProp</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="n">yMKS</span> <span class="o">=</span> <span class="n">MKSmodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c">#getPlots(y, yMKS, MKSmodel)</span>

<span class="n">resize</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">XL</span> <span class="o">=</span> <span class="n">getRand</span><span class="p">(</span><span class="n">resize</span> <span class="o">*</span> <span class="n">L</span><span class="p">)</span>
<span class="n">y_resize</span> <span class="o">=</span> <span class="n">FEmodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">getProp</span><span class="p">(</span><span class="n">XL</span><span class="p">))</span>
<span class="n">MKSmodel</span><span class="o">.</span><span class="n">resize_coeff</span><span class="p">((</span><span class="n">resize</span> <span class="o">*</span> <span class="n">L</span><span class="p">,</span> <span class="n">resize</span> <span class="o">*</span> <span class="n">L</span><span class="p">))</span>
<span class="n">y_resizeMKS</span> <span class="o">=</span> <span class="n">MKSmodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XL</span><span class="p">)</span>
<span class="n">getPlots</span><span class="p">(</span><span class="n">y_resize</span><span class="p">,</span> <span class="n">y_resizeMKS</span><span class="p">,</span> <span class="n">MKSmodel</span><span class="p">)</span>
<span class="c">#getCoeffplots(MKSmodel)</span>

<span class="n">BigDel</span> <span class="o">=</span> <span class="n">getDel</span><span class="p">(</span><span class="n">resize</span> <span class="o">*</span> <span class="n">L</span><span class="p">)</span>
<span class="n">BigMKSmodel</span> <span class="o">=</span> <span class="n">MKSRegressionModel</span><span class="p">(</span><span class="n">Nbin</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">BigMKSmodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">BigDel</span><span class="p">,</span> <span class="n">FEmodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">getProp</span><span class="p">(</span><span class="n">BigDel</span><span class="p">))[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="c">#getCoeffplots(BigMKSmodel)</span>

<span class="n">yBig</span> <span class="o">=</span> <span class="n">BigMKSmodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XL</span><span class="p">)</span>
<span class="n">getPlots</span><span class="p">(</span><span class="n">y_resize</span><span class="p">,</span> <span class="n">yBig</span><span class="p">,</span> <span class="n">BigMKSmodel</span><span class="p">)</span>

<span class="n">Bigcoeff</span> <span class="o">=</span> <span class="n">BigMKSmodel</span><span class="o">.</span><span class="n">coeff</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">resized_coeff</span> <span class="o">=</span> <span class="n">MKSmodel</span><span class="o">.</span><span class="n">coeff</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">resized_coeff</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">Bigcoeff</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Coeff0 Absolute Error %&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><pre>sfepy: matrix shape: (1151, 1151)
sfepy: assembling matrix graph...
sfepy: ...done in 0.00 s
sfepy: matrix structural nonzeros: 35087 (2.65e-02% fill)
sfepy: matrix shape: (1151, 1151)
sfepy: assembling matrix graph...
sfepy: ...done in 0.00 s
sfepy: matrix structural nonzeros: 35087 (2.65e-02% fill)
sfepy: matrix shape: (1151, 1151)
sfepy: assembling matrix graph...
sfepy: ...done in 0.00 s
sfepy: matrix structural nonzeros: 35087 (2.65e-02% fill)
sfepy: matrix shape: (18431, 18431)
sfepy: assembling matrix graph...
sfepy: ...done in 0.04 s
sfepy: matrix structural nonzeros: 582863 (1.72e-03% fill)
sfepy: matrix shape: (18431, 18431)
sfepy: assembling matrix graph...
sfepy: ...done in 0.04 s
sfepy: matrix structural nonzeros: 582863 (1.72e-03% fill)
sfepy: matrix shape: (18431, 18431)
sfepy: assembling matrix graph...
sfepy: ...done in 0.04 s
sfepy: matrix structural nonzeros: 582863 (1.72e-03% fill)</pre>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.colorbar.Colorbar instance at 0x6171cb0&gt;</pre>
</div>
<img alt="../_images/sandbox_34_2.png" src="../_images/sandbox_34_2.png" />
<img alt="../_images/sandbox_34_3.png" src="../_images/sandbox_34_3.png" />
<img alt="../_images/sandbox_34_4.png" src="../_images/sandbox_34_4.png" />
<img alt="../_images/sandbox_34_5.png" src="../_images/sandbox_34_5.png" />
<img alt="../_images/sandbox_34_6.png" src="../_images/sandbox_34_6.png" />
<img alt="../_images/sandbox_34_7.png" src="../_images/sandbox_34_7.png" />
<img alt="../_images/sandbox_34_8.png" src="../_images/sandbox_34_8.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">Length</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">k0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">BigDel</span> <span class="o">=</span> <span class="n">getDel</span><span class="p">((</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Length</span><span class="p">)</span>
    <span class="n">BigMKSmodel</span> <span class="o">=</span> <span class="n">MKSRegressionModel</span><span class="p">(</span><span class="n">Nbin</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">BigMKSmodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">BigDel</span><span class="p">,</span> <span class="n">FEmodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">getProp</span><span class="p">(</span><span class="n">BigDel</span><span class="p">))[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">print</span> <span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Length</span>
    <span class="n">s</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">BigMKSmodel</span><span class="o">.</span><span class="n">coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">k0</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">BigMKSmodel</span><span class="o">.</span><span class="n">Fcoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><pre>sfepy: matrix shape: (647, 647)
sfepy: assembling matrix graph...
sfepy: ...done in 0.00 s
sfepy: matrix structural nonzeros: 19391 (4.63e-02% fill)
sfepy: matrix shape: (647, 647)
sfepy: assembling matrix graph...
sfepy: ...done in 0.00 s
sfepy: matrix structural nonzeros: 19391 (4.63e-02% fill)
9
sfepy: matrix shape: (2591, 2591)
sfepy: assembling matrix graph...
sfepy: ...done in 0.01 s
sfepy: matrix structural nonzeros: 80303 (1.20e-02% fill)
sfepy: matrix shape: (2591, 2591)
sfepy: assembling matrix graph...
sfepy: ...done in 0.01 s
sfepy: matrix structural nonzeros: 80303 (1.20e-02% fill)
18
sfepy: matrix shape: (5831, 5831)
sfepy: assembling matrix graph...
sfepy: ...done in 0.01 s
sfepy: matrix structural nonzeros: 182687 (5.37e-03% fill)
sfepy: matrix shape: (5831, 5831)
sfepy: assembling matrix graph...
sfepy: ...done in 0.01 s
sfepy: matrix structural nonzeros: 182687 (5.37e-03% fill)
27
sfepy: matrix shape: (10367, 10367)
sfepy: assembling matrix graph...
sfepy: ...done in 0.02 s
sfepy: matrix structural nonzeros: 326543 (3.04e-03% fill)
sfepy: matrix shape: (10367, 10367)
sfepy: assembling matrix graph...
sfepy: ...done in 0.02 s
sfepy: matrix structural nonzeros: 326543 (3.04e-03% fill)
36
sfepy: matrix shape: (16199, 16199)
sfepy: assembling matrix graph...
sfepy: ...done in 0.03 s
sfepy: matrix structural nonzeros: 511871 (1.95e-03% fill)
sfepy: matrix shape: (16199, 16199)
sfepy: assembling matrix graph...
sfepy: ...done in 0.04 s
sfepy: matrix structural nonzeros: 511871 (1.95e-03% fill)
45</pre>
</div>
<div class="highlight-python"><pre>-c:12: ComplexWarning: Casting complex values to real discards the imaginary part</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;real space&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">k0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;K space&#39;</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">k0</span><span class="o">/</span><span class="n">k0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span> <span class="n">y</span>
<span class="k">print</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mf">1.</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">s</span><span class="o">/</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span> <span class="n">ys</span>
<span class="k">print</span> <span class="mf">1.</span><span class="o">/</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="mf">1.</span><span class="p">)</span><span class="o">**</span><span class="mf">3.</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[ 1.          0.5         0.33333333  0.25        0.2       ]
[ 1.          0.5         0.33333333  0.25        0.2       ]
[ 1.          0.125       0.03703704  0.015625    0.008     ]
[ 1.          0.125       0.03703704  0.015625    0.008     ]</pre>
</div>
<img alt="../_images/sandbox_36_1.png" src="../_images/sandbox_36_1.png" />
<img alt="../_images/sandbox_36_2.png" src="../_images/sandbox_36_2.png" />
<div class="highlight-python"><pre>&lt;matplotlib.figure.Figure at 0x4f15610&gt;</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pymks.datasets.microstructureGenerator</span> <span class="kn">import</span> <span class="n">MicrostructureGenerator</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">m</span> <span class="o">=</span> <span class="n">MicrostructureGenerator</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><pre>&lt;matplotlib.image.AxesImage at 0x7f7250798110&gt;</pre>
</div>
<img alt="../_images/sandbox_40_1.png" src="../_images/sandbox_40_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.filter</span> <span class="kn">import</span> <span class="n">crosscorrelate</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.bases</span> <span class="kn">import</span> <span class="n">DiscreteIndicatorBasis</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">DiscreteIndicatorBasis</span><span class="p">(</span><span class="n">n_states</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="k">print</span> <span class="n">X_</span><span class="o">.</span><span class="n">shape</span>
<span class="k">print</span> <span class="n">X_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">X_</span> <span class="o">=</span> <span class="n">basis</span><span class="o">.</span><span class="n">discretize</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">crosscorrelate</span><span class="p">(</span><span class="n">X_</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="mi">2</span>
</pre></div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>