

<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Cahn-Hilliard &mdash; PyMKS</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.1.0/cosmo/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pymks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/pymks_logo.ico"/>
    <link rel="top" title="PyMKS" href="../index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/pymks_logo.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.1-dev</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="INSTALLATION.html">Installation</a></li>
                <li><a href="../EXAMPLES.html">Examples</a></li>
                <li><a href="../API.html">API</a></li>
                <li><a href="https://github.com/wd15/pymks/">Github</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">More <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../THEORY.html">Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="derivation.html">Derivation of Materials Knowledge Systems Equation using Linear Elasticity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="CREDITS.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="LICENSE.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="CITATION.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="REQUIREMENTS.html">Requirements</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="cahn-hilliard">
<h1>Cahn-Hilliard<a class="headerlink" href="#cahn-hilliard" title="Permalink to this headline">¶</a></h1>
<p>This example demonstrates how to use PyMKS to quickly produce phase
field results from a Cahn-Hilliard simulation. The first section
provides some background information about the Cahn-Hilliard equation as
well as details behind the Cahn-Hilliard simulation used to calibration
and validate the MKS model. The example then goes on to demonstrate how
to generate calibration data to calibrate the influence coefficients
using linear regression. As part of the calibration process, the example
explains how to pick an appropriate number of local states for the MKS
model when state space is continuous. The Cahn-Hilliard simulation and
the MKS model with calibrated influence coefficients are then used to
predict the microstructure evolution from a given initial concentration
and the results are compared. Finally, the influence coefficients are
scaled up and used to predict the evolution for a much larger system.</p>
<div class="section" id="cahn-hilliard-equation">
<h2>Cahn-Hilliard Equation<a class="headerlink" href="#cahn-hilliard-equation" title="Permalink to this headline">¶</a></h2>
<p>The Cahn-Hilliard equation is used to simulation microstructure
evolution during spinodial decompation. The equation take the following
form.</p>
<div class="math">
\[\frac{\partial \phi}{\partial t} = \nabla \cdot D \nabla \Bigg ( \frac{\partial f}{\partial \phi} + \epsilon^2 \nabla^2 \phi \Bigg )\]</div>
<p><span class="math">\(\phi\)</span> is an conserved ordered parameter which can represent alloy
composition, <span class="math">\(D\)</span> is the diffusion coefficient,
<span class="math">\(f(\phi(x,t))\)</span> is the free energy function, and <span class="math">\(\epsilon\)</span>
is the length of interface region. <span class="math">\(f(ϕ(x,t))\)</span> is a double well
potential and can be represented as a fourth-order polynomial.</p>
<div class="math">
\[f = \frac{a^2}{2}\phi^2 (1 - \phi)^2\]</div>
<p>The free paramter <span class="math">\(a\)</span> can be used to control the height of the
free energy function while the free parameter $ $ can be used to control
to interface width. The double well provides the thermodynamic driving
force for phase seperation. While the gradient energy term
<span class="math">\(\epsilon^2 \nabla^2 \phi\)</span> provides the driving force to keep the
interface between the phases continous.</p>
<p>In this example, a 2D concentration fields <span class="math">\(\phi\)</span> are simulated by
solving the Cahn-Hilliard equation using the spectral method with
periodic boundary conditions [1]. The simulated concentration fields are
used to both calibrate the influence coefficients and validate the
accuracy of the MKS model.</p>
<div class="code python highlight-python"><pre>%matplotlib inline
%load_ext autoreload
%autoreload 2

import numpy as np
import matplotlib.pyplot as plt</pre>
</div>
<div class="section" id="modeling-with-mks">
<h3>Modeling with MKS<a class="headerlink" href="#modeling-with-mks" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="calibration-datasets">
<h2>Calibration Datasets<a class="headerlink" href="#calibration-datasets" title="Permalink to this headline">¶</a></h2>
<p>Unlike the elastostatic examples, the microstructure (concentration
field) for this simulation doesn&#8217;t have discrete phases. The
microstructure is a continuous field that can have a range of values
which can change over time, therefore the first order influence
coefficients cannot be calibrated with delta microstructures. Instead a
large number of simulations with random initial conditions are used to
calibrate the first order influence coefficients using linear
regression. Let&#8217;s show how this is done.</p>
<p>The function <tt class="docutils literal"><span class="pre">make_cahnHilliard</span></tt> from <tt class="docutils literal"><span class="pre">pymks.datasets</span></tt> provides a
nice interface to generate calibration datasets for the influence
coefficients. To use <tt class="docutils literal"><span class="pre">make_cahnHilliard</span></tt>, we need to set the number of
samples we want to use to calibrate the influence coefficients using
<tt class="docutils literal"><span class="pre">n_samples</span></tt> as well as the size of the simulation using <tt class="docutils literal"><span class="pre">size</span></tt>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pymks</span>
<span class="kn">from</span> <span class="nn">pymks.datasets</span> <span class="kn">import</span> <span class="n">make_cahnHilliard</span>

<span class="n">L</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">400</span>
<span class="n">dt</span><span class="o">=</span><span class="mf">1e-2</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_cahnHilliard</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">),</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
<p>The function <tt class="docutils literal"><span class="pre">make_cahnHilliard</span></tt> has generated <tt class="docutils literal"><span class="pre">n_samples</span></tt> number of
random microstructures <tt class="docutils literal"><span class="pre">X</span></tt> and returned the same microstructures after
they have evolved one time step <tt class="docutils literal"><span class="pre">y</span></tt>. Let&#8217;s take a look at one of them.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.tools</span> <span class="kn">import</span> <span class="n">draw_concentrations</span>

<span class="n">draw_concentrations</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title0</span><span class="o">=</span><span class="s">&#39;time=0&#39;</span><span class="p">,</span> <span class="n">title1</span><span class="o">=</span><span class="s">&#39;time = 1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>/home/wd15/anaconda/lib/python2.7/site-packages/matplotlib/figure.py:1595: UserWarning: This figure includes Axes that are not compatible with tight_layout, so its results might be incorrect.
  warnings.warn("This figure includes Axes that are not "</pre>
</div>
<img alt="../_images/cahn_hilliard_6_1.png" src="../_images/cahn_hilliard_6_1.png" />
</div>
<div class="section" id="calibrate-influence-coefficients">
<h2>Calibrate Influence Coefficients<a class="headerlink" href="#calibrate-influence-coefficients" title="Permalink to this headline">¶</a></h2>
<p>As mentioned above, the microstructures (concentration fields) does not
have discrete phases. This leaves the number of local states in local
state space as a free hyper parameter. In previous work it has been
shown that as you increase the number of local states, the accuracy of
MKS model increases [2], but as the number of local states increases,
the difference in accuracy decreases. Some work needs to be done in
order to find the practical number of local states that we will use.</p>
<p>Let&#8217;s split the calibrate dataset into testing and training datasets.
The function <tt class="docutils literal"><span class="pre">train_test_split</span></tt> for the machine learning python module
<tt class="docutils literal"><span class="pre">`sklearn</span></tt> &lt;<a class="reference external" href="http://scikit-learn.org/stable/">http://scikit-learn.org/stable/</a>&gt;`__ provides a convenient
interface to do this. 80% of the dataset will be used for training and
the remaining 20% will be used for testing by setting <tt class="docutils literal"><span class="pre">test_size</span></tt>
equal to 0.2. The state of the random number generator used to make the
split can be set using <tt class="docutils literal"><span class="pre">random_state</span></tt>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sklearn</span>
<span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="k">print</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
<p>We are now going to calibrate the influence coefficients while varying
the number of local states from 2 up to 20. Each of these models will
then predict the evolution of the concentration fields. Mean square
error will be used to compared the results with the testing dataset to
evaluate how the MKS model&#8217;s performance changes as we change the number
of local states.</p>
<p>First we need to import the class <tt class="docutils literal"><span class="pre">MKSRegressionModel</span></tt> from <tt class="docutils literal"><span class="pre">pymks</span></tt>.
We will also use metrics from <tt class="docutils literal"><span class="pre">sklearn</span></tt> to calculate the mean squared
error.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span>

<span class="kn">from</span> <span class="nn">pymks</span> <span class="kn">import</span> <span class="n">MKSRegressionModel</span>
<span class="kn">from</span> <span class="nn">pymks.bases</span> <span class="kn">import</span> <span class="n">ContinuousIndicatorBasis</span>
</pre></div>
</div>
<p>Next we will calibrate the influence coefficients while varying the
number of local states and compute the mean squared error. The following
demonstrates how to use Scikit-learn&#8217;s <tt class="docutils literal"><span class="pre">GridSearchCV</span></tt> to optimize
<tt class="docutils literal"><span class="pre">n_states</span></tt> as a hyperparameter. Of course, the best fit is always with
a larger value of <tt class="docutils literal"><span class="pre">n_states</span></tt>. Increasing this parameter does not
overfit the data.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sklearn.grid_search</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>

<span class="n">parameters_to_tune</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;n_states&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">)}</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">ContinuousIndicatorBasis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MKSRegressionModel</span><span class="p">(</span><span class="n">basis</span><span class="p">)</span>
<span class="n">scoring</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">make_scorer</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="o">-</span><span class="n">mse</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">parameters_to_tune</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">)</span>
<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>GridSearchCV(cv=5,
       estimator=MKSRegressionModel(basis=&lt;pymks.bases.continuous.ContinuousIndicatorBasis object at 0x7fa61aabfd10&gt;,
          n_states=2),
       fit_params={}, iid=True, loss_func=None, n_jobs=1,
       param_grid={'n_states': array([ 2,  3,  4,  5,  6,  7,  8,  9, 10])},
       pre_dispatch='2*n_jobs', refit=True, score_func=None,
       scoring=make_scorer(&lt;lambda&gt;), verbose=0)</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">print</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><pre>MKSRegressionModel(basis=&lt;pymks.bases.continuous.ContinuousIndicatorBasis object at 0x7fa61a8b2fd0&gt;,
          n_states=10)
0.999999081316</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.tools</span> <span class="kn">import</span> <span class="n">draw_gridscores</span>

<span class="n">draw_gridscores</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">grid_scores_</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/cahn_hilliard_14_0.png" src="../_images/cahn_hilliard_14_0.png" />
<p>As expected the accuracy of the MKS model monotonically increases as we
increase n_states, but accuracy doesn&#8217;t improve significantly as
n_states gets larger than signal digits.</p>
<p>In order to save on computation costs let&#8217;s set calibrate the influence
coefficients with <tt class="docutils literal"><span class="pre">n_states</span></tt> equal to 6, but realize that if we need
slightly more accuracy the value can be increased.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">MKSmodel</span> <span class="o">=</span> <span class="n">MKSRegressionModel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">ContinuousIndicatorBasis</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="n">MKSmodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>Here are the first 4 influence coefficients.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.tools</span> <span class="kn">import</span> <span class="n">draw_coeff</span>

<span class="n">draw_coeff</span><span class="p">(</span><span class="n">MKSmodel</span><span class="o">.</span><span class="n">coeff</span><span class="p">[</span><span class="o">...</span><span class="p">,:</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../_images/cahn_hilliard_18_0.png" src="../_images/cahn_hilliard_18_0.png" />
</div>
<div class="section" id="predict-microstructure-evolution">
<h2>Predict Microstructure Evolution<a class="headerlink" href="#predict-microstructure-evolution" title="Permalink to this headline">¶</a></h2>
<p>With the calibrated influence coefficients, we are ready to predict the
evolution of a concentration field. In order to do this, we need to have
the Cahn-Hilliard simulation and the MKS model start with the same
initial concentration <tt class="docutils literal"><span class="pre">phi0</span></tt> and evolve in time. In order to do the
Cahn-Hilliard simulation we need an instance of the class
<tt class="docutils literal"><span class="pre">CahnHilliardSimulation</span></tt>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.datasets.cahnHilliardSimulation</span> <span class="kn">import</span> <span class="n">CahnHilliardSimulation</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">191</span><span class="p">)</span>

<span class="n">phi0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">CHSim</span> <span class="o">=</span> <span class="n">CahnHilliardSimulation</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">phi0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">phi_pred</span> <span class="o">=</span> <span class="n">phi0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<p>In order to move forward in time, we need to feed the concentration back
into the Cahn-Hilliard simulation and the MKS model.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">time_steps</span> <span class="o">=</span> <span class="mi">10</span>

<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">time_steps</span><span class="p">):</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">CHSim</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">phi_pred</span> <span class="o">=</span> <span class="n">MKSmodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">phi_pred</span><span class="p">)</span>
</pre></div>
</div>
<p>Let&#8217;s take a look at the concentration fields.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.tools</span> <span class="kn">import</span> <span class="n">draw_concentrations_compare</span>

<span class="n">draw_concentrations_compare</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">phi_pred</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../_images/cahn_hilliard_24_0.png" src="../_images/cahn_hilliard_24_0.png" />
<p>The MKS model was able to capture the microstructure evolution with 6
local states.</p>
<div class="section" id="resizing-the-coefficients-to-use-on-larger-systems">
<h3>Resizing the Coefficients to use on Larger Systems<a class="headerlink" href="#resizing-the-coefficients-to-use-on-larger-systems" title="Permalink to this headline">¶</a></h3>
<p>Now let&#8217;s try and predict a larger simulation by resizing the
coefficients and provide a larger initial concentratio field.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">N</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">L</span>
<span class="n">MKSmodel</span><span class="o">.</span><span class="n">resize_coeff</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>

<span class="n">phi0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">phi0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">phi_pred</span> <span class="o">=</span> <span class="n">phi0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<p>Once again we are going to march forward in time by feeding the
concentration fields back into the Cahn-Hilliard simulation and the MKS
model.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">CHSim</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">phi_pred</span> <span class="o">=</span> <span class="n">MKSmodel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">phi_pred</span><span class="p">)</span>
</pre></div>
</div>
<p>Let&#8217;s take a look at the results.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.tools</span> <span class="kn">import</span> <span class="n">draw_concentrations_compare</span>

<span class="n">draw_concentrations_compare</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">phi_pred</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../_images/cahn_hilliard_30_0.png" src="../_images/cahn_hilliard_30_0.png" />
<p>The MKS model with resized influence coefficients was able to reasonably
predict the structure evolution for a larger concentration field.</p>
</div>
<div class="section" id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h3>
<p>[1] Ye X., Cheng X., The Fourier spectral method for the Cahn-Hilliard
equation. Applied Mathematics and Computation, 171, 1, 345-357, 2005.
<a class="reference external" href="http://dx.doi.org/10.1016/j.amc.2005.01.050">doi:10.1016/j.amc.2005.01.050</a></p>
<p>[2] Fast T., Niezgoda S., Kalidindi S.R., A new framework for
computationally efficient structure–structure evolution linkages to
facilitate high-fidelity scale bridging in multi-scale materials models
59, 2, 699-707, 2011.
<a class="reference external" href="http://dx.doi.org/10.1016/j.actamat.2010.10.008">doi:10.1016/j.actamat.2010.10.008</a></p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>