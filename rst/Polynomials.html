

<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>&lt;no title&gt; &mdash; PyMKS</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.1.0/cosmo/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pymks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/pymks_logo.ico"/>
    <link rel="top" title="PyMKS" href="../index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/pymks_logo.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.1-dev</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="INSTALLATION.html">Installation</a></li>
                <li><a href="../EXAMPLES.html">Examples</a></li>
                <li><a href="../API.html">API</a></li>
                <li><a href="https://github.com/openmaterials/pymks/">Github</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">More <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../THEORY.html">Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="derivation.html">Derivation of Materials Knowledge Systems Equation using Linear Elasticity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="CREDITS.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="LICENSE.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="CITATION.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="REQUIREMENTS.html">Requirements</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="code python highlight-python"><pre>%matplotlib inline

import numpy as np
import scipy as sp
import matplotlib.pyplot as plt
Lg = np.polynomial.Legendre
lg = np.polynomial.legendre</pre>
</div>
<p>We want to represent the microstructure function in terms of a series of
basis functions. In this case we are going to go with the Legendre
polynomials.</p>
<div class="math">
\[m_s(h) = \sum_{l = 0}^\infty c_{ls} P_l (h)\]</div>
<p>The coefficients of this series can be found with the following equation</p>
<div class="math">
\[c_{ls} = (2l +1) \int_{-1}^1 P_l (h) m_s(h)\]</div>
<p>If in location <span class="math">\(s\)</span> there is only one value of concentration rather
than a distribution of states the microstructure function is a delta
function.</p>
<div class="math">
\[m_s(h) = \delta_s(h - h0)\]</div>
<p>Therefore</p>
<div class="math">
\[c_{ls} = (2l +1) \int_{-1}^1 P_l (h) \delta_s(h - h0)\]</div>
<div class="math">
\[c_{ls} = (2l +1)  P_l (h0)\]</div>
<p>Let&#8217;s find the first 4 coefficients for <span class="math">\(h0 = 0.25\)</span></p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">n_coeffs</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">h0</span> <span class="o">=</span> <span class="mf">0.25</span>

<span class="n">coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_coeffs</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_coeffs</span><span class="p">):</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">Lg</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
    <span class="n">coeff</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">P</span><span class="p">(</span><span class="n">h0</span><span class="p">)</span>

<span class="k">print</span> <span class="n">coeff</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[ 1.         0.75      -2.03125   -2.3515625]</pre>
</div>
<p>Here is some thoughts on doing it without loops.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">eval_h0</span><span class="p">(</span><span class="n">h0</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">norm</span><span class="p">):</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="n">basis</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">norm</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="o">*</span> <span class="n">basis</span><span class="p">(</span><span class="n">h0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_get_basis</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">norm</span><span class="p">):</span>
    <span class="n">basis_array</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
        <span class="n">basis_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">*</span> <span class="n">basis</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">ii</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">basis_array</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Legendre_norm</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">_get_states_array</span><span class="p">(</span><span class="n">X_shape</span><span class="p">,</span> <span class="n">n_states</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">X_shape</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">n_states</span><span class="p">,))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_states</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">eval_h0_vect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">eval_h0</span><span class="p">))</span>
</pre></div>
</div>
<div class="code python highlight-python"><pre>X = np.array([[0.25, 0.1], [0.5, 0.25]])

lg.legval
norm = np.eye(3) * ( 2 * np.arange(3) + 1)
print norm
#weights = 2 * np.arange(3) + 1
#print ieys * weights
print lg.legval(X, norm, domain=).T</pre>
</div>
<div class="highlight-python"><pre>[[-0.5 -0.8]
 [ 0.  -0.5]]
[[ 1.  0.  0.]
 [ 0.  3.  0.]
 [ 0.  0.  5.]]
(2, 2, 3)</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">pymks.basis</span> <span class="kn">import</span> <span class="n">Legendre</span>
<span class="n">X_Legendre</span> <span class="o">=</span> <span class="n">Legendre</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="k">print</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
<span class="k">print</span> <span class="n">X_Legendre</span><span class="o">.</span><span class="n">shape</span>
<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">X_Legendre</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_Legendre</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span>
<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">X_Legendre</span><span class="p">[</span><span class="o">...</span><span class="p">,])</span>
<span class="c">#print X</span>
<span class="c">#print X_Legendre</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)

&lt;ipython-input-68-3b72d3986331&gt; in &lt;module&gt;()
      7 print X_Legendre.shape
      8 print np.rollaxis(X_Legendre, 0, len(X_Legendre.shape)).shape
----&gt; 9 print np.flip(up)
     10 #print X
     11 #print X_Legendre


AttributeError: 'module' object has no attribute 'flip'</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pymks</span>
<span class="kn">from</span> <span class="nn">pymks.datasets</span> <span class="kn">import</span> <span class="n">make_cahnHilliard</span>

<span class="n">L</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">400</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_cahnHilliard</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">))</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.basis</span> <span class="kn">import</span> <span class="n">Legendre_fft</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">Legendre_fft</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.tools</span> <span class="kn">import</span> <span class="n">draw_concentrations</span>

<span class="n">draw_concentrations</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><pre>/home/david/anaconda/lib/python2.7/site-packages/matplotlib/figure.py:1595: UserWarning: This figure includes Axes that are not compatible with tight_layout, so its results might be incorrect.
  warnings.warn("This figure includes Axes that are not "</pre>
</div>
<img alt="../_images/Polynomials_10_1.png" src="../_images/Polynomials_10_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.tools</span> <span class="kn">import</span> <span class="n">optimize_n_states</span>

<span class="n">n_states_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<span class="n">optm_n_states</span> <span class="o">=</span> <span class="n">optimize_n_states</span><span class="p">(</span><span class="n">n_states_values</span><span class="o">=</span><span class="n">n_states_values</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">print</span> <span class="n">A</span>
<span class="c">#print A[..., 0]</span>
<span class="c">#print np.flipud(A[..., 0])</span>
<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">fliplr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[[[ 0  1]
  [ 2  3]]

 [[ 4  5]
  [ 6  7]]

 [[ 8  9]
  [10 11]]]
[[[ 2  3]
  [ 0  1]]

 [[ 6  7]
  [ 4  5]]

 [[10 11]
  [ 8  9]]]
[[[ 8  9]
  [10 11]]

 [[ 4  5]
  [ 6  7]]

 [[ 0  1]
  [ 2  3]]]
[[[ 8  4  0]
  [ 9  5  1]]

 [[10  6  2]
  [11  7  3]]]</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pymks.basis</span> <span class="kn">import</span> <span class="n">Chebyshev</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]])</span>

<span class="n">Chebyshev</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[[ 0.31830989  0.          0.        ]
 [ 0.          0.63661977  0.        ]
 [ 0.          0.          0.63661977]]</pre>
</div>
<div class="highlight-python"><pre>/home/david/anaconda/lib/python2.7/site-packages/numpy/polynomial/chebyshev.py:1937: RuntimeWarning: divide by zero encountered in true_divide
  w = 1./(np.sqrt(1. + x) * np.sqrt(1. - x))
/home/david/anaconda/lib/python2.7/site-packages/numpy/polynomial/chebyshev.py:1179: RuntimeWarning: invalid value encountered in multiply
  c1 = tmp + c1*x2</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[[</span><span class="o">-</span><span class="mf">0.21220659</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3675526</span> <span class="p">,</span>  <span class="mf">0.31830989</span><span class="p">],</span>
        <span class="p">[</span>        <span class="n">inf</span><span class="p">,</span>         <span class="n">nan</span><span class="p">,</span>         <span class="n">nan</span><span class="p">]],</span>

       <span class="p">[[</span>        <span class="n">inf</span><span class="p">,</span>         <span class="n">nan</span><span class="p">,</span>         <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.21220659</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3675526</span> <span class="p">,</span>  <span class="mf">0.31830989</span><span class="p">]]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">cheb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polynomial</span><span class="o">.</span><span class="n">chebyshev</span>
<span class="n">cheb</span><span class="o">.</span><span class="n">chebval</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">cheb</span><span class="o">.</span><span class="n">chebweight</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">1.0</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">scipy</span> <span class="kn">as</span> <span class="nn">sp</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]])</span>
<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">eval_chebyu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">X</span><span class="p">))</span>
<span class="n">sp</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">eval_chebyu</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[[ 0.  0.  0.  0.]
 [ 0.  1.  0.  0.]
 [ 0.  0.  2.  0.]
 [ 0.  0.  0.  3.]]</pre>
</div>
<div class="highlight-python"><pre>---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)

&lt;ipython-input-14-2977541692a3&gt; in &lt;module&gt;()
      2 print np.arange(4) * np.eye(4)
      3 np.flipud(sp.special.eval_chebyu(np.arange(2), X))
----&gt; 4 sp.special.eval_chebyu(X, np.arange(4))


ValueError: operands could not be broadcast together with shapes (2,2) (4,)</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">herm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polynomial</span><span class="o">.</span><span class="n">hermite</span>
<span class="n">X_weight</span> <span class="o">=</span> <span class="n">herm</span><span class="o">.</span><span class="n">hermweight</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">n</span><span class="p">)</span> <span class="o">**</span> <span class="o">-</span><span class="mi">1</span>
<span class="k">print</span> <span class="n">X</span>
<span class="k">print</span> <span class="n">norm</span>
<span class="k">print</span> <span class="n">X_weight</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[[ 0.25  0.  ]
 [ 1.    0.25]]
[ 0.56418958  0.28209479  0.0705237 ]
[[[ 0.93941306  0.93941306  0.93941306]
  [ 1.          1.          1.        ]]

 [[ 0.36787944  0.36787944  0.36787944]
  [ 0.93941306  0.93941306  0.93941306]]]</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">X_Hermite</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">herm</span><span class="o">.</span><span class="n">hermval</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">norm</span><span class="p">))</span>
<span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">X_Hermite</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_Hermite</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span> <span class="o">*</span> <span class="n">X_weight</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[[[-0.11593905  0.13250177  0.53000706]
  [-0.1410474   0.          0.56418958]]

 [[ 0.05188844  0.20755375  0.20755375]
  [-0.11593905  0.13250177  0.53000706]]]</pre>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pymks.basis</span> <span class="kn">import</span> <span class="n">Hermite</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]])</span>
<span class="n">Hermite</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[[</span><span class="o">-</span><span class="mf">0.11593905</span><span class="p">,</span>  <span class="mf">0.13250177</span><span class="p">,</span>  <span class="mf">0.53000706</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.1410474</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.56418958</span><span class="p">]],</span>

       <span class="p">[[</span> <span class="mf">0.05188844</span><span class="p">,</span>  <span class="mf">0.20755375</span><span class="p">,</span>  <span class="mf">0.20755375</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.11593905</span><span class="p">,</span>  <span class="mf">0.13250177</span><span class="p">,</span>  <span class="mf">0.53000706</span><span class="p">]]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.basis</span> <span class="kn">import</span> <span class="n">Legendre</span>
<span class="n">Xleg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]])</span>
<span class="n">Legendre</span><span class="p">(</span><span class="n">Xleg</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[[</span><span class="o">-</span><span class="mf">0.3125</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.75</span>  <span class="p">,</span>  <span class="mf">0.5</span>   <span class="p">],</span>
        <span class="p">[</span> <span class="mf">1.15</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span>   <span class="p">,</span>  <span class="mf">0.5</span>   <span class="p">]],</span>

       <span class="p">[[</span><span class="o">-</span><span class="mf">1.25</span>  <span class="p">,</span>  <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">0.5</span>   <span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.3125</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.75</span>  <span class="p">,</span>  <span class="mf">0.5</span>   <span class="p">]]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.basis</span> <span class="kn">import</span> <span class="n">Hermite</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">Hermite</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]),</span> <span class="n">deg</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[[</span><span class="o">-</span><span class="mf">0.01729615</span><span class="p">,</span>  <span class="mf">0.05188844</span><span class="p">,</span>  <span class="mf">0.20755375</span><span class="p">,</span>  <span class="mf">0.20755375</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.1410474</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.56418958</span><span class="p">]],</span>

       <span class="p">[[</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.1410474</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.56418958</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.01729615</span><span class="p">,</span>  <span class="mf">0.05188844</span><span class="p">,</span>  <span class="mf">0.20755375</span><span class="p">,</span>  <span class="mf">0.20755375</span><span class="p">]]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pymks.microstructureFunction</span> <span class="kn">import</span> <span class="n">MicrostructureFunction</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">n_states</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">FX_</span> <span class="o">=</span> <span class="n">MicrostructureFunction</span><span class="p">(</span><span class="n">n_states</span><span class="p">)</span><span class="o">.</span><span class="n">_Legendre_fft</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">n_states</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="k">print</span> <span class="n">FX_</span>
<span class="n">X_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifftn</span><span class="p">(</span><span class="n">FX_</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_states</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[[[[ 3.70264051+0.j         -5.29735949+0.j        ]
   [-1.00887157-1.48005289j -1.00887157-1.48005289j]
   [-1.00887157+1.48005289j -1.00887157+1.48005289j]]

  [[ 0.62300683-4.97732233j  0.62300683-4.97732233j]
   [ 1.09318216+0.10131035j  1.09318216+0.10131035j]
   [ 0.37713401+1.87334545j  0.37713401+1.87334545j]]

  [[ 0.62300683+4.97732233j  0.62300683+4.97732233j]
   [ 0.37713401-1.87334545j  0.37713401-1.87334545j]
   [ 1.09318216-0.10131035j  1.09318216-0.10131035j]]]]</pre>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>